<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Mappe dinamiche</title>
  <style>
    body {
    font-family: sans-serif;
    margin: 20px;
    }

    #mapsWrapper {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px;
    }

    @media (max-width: 800px) {
    #mapsWrapper {
        grid-template-columns: 1fr; /* Diventa 1x4 sotto gli 800px */
    }
    }

    .map-block {
    display: flex;
    flex-direction: column;
    }

    .map-container {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* Rapporto 16:9 */
    height: 0;
    overflow: hidden;
    }

    .map-container iframe {
    position: absolute;
    width: 100%; /* Forza l'iframe ad adattarsi alla larghezza del contenitore */
    height: 100%; /* Forza l'iframe ad adattarsi all'altezza del contenitore */
    border: none;
    }

    /* Specifico per i grafici, se necessario */
    .map-container iframe[src*="pubchart"] {
    object-fit: contain; /* Mantiene il grafico visibile senza deformazioni */
    }

    select {
    width: 100%;
    font-size: 16px;
    padding: 8px;
    margin-bottom: 10px;
    }

  </style>
</head>
<body>

<h2>Seleziona le mappe</h2>
<div id="mapsWrapper"></div>

<script>
  const mapOptions = [
    { name: "Mappa 1", url: "https://gabrielepiccoli.github.io/test_page/heatmap_1.html" },
    { name: "Mappa 2", url: "https://gabrielepiccoli.github.io/test_page/heatmap_2.html" },
    { name: "Mappa 3", url: "https://gabrielepiccoli.github.io/test_page/heatmap_3.html" },
    { name: "Mappa 4", url: "https://gabrielepiccoli.github.io/test_page/heatmap.html" },
    { name: "Grafico 1", url: "https://lookerstudio.google.com/embed/reporting/b54a3a10-5148-4dc7-bd08-2b7140fa78aa/page/mS6HF"},
    { name: "Grafico 2", url: "https://lookerstudio.google.com/embed/reporting/321f4b6a-079b-459b-a979-d164dd48aa71/page/mS6HF" },
    { name: "Grafico 3", url: "https://lookerstudio.google.com/embed/reporting/40fa0638-a0dd-4fea-b7e8-049a73a8ae49/page/mS6HF" },
    { name: "Grafico 4", url: "https://lookerstudio.google.com/embed/reporting/c6b9be92-3896-4370-a2fc-06a4150f350a/page/mS6HF" },
  ];
  const numberOfBlocks = 4;
const wrapper = document.getElementById("mapsWrapper");

function createMapBlock(index) {
  const mapBlock = document.createElement("div");
  mapBlock.className = "map-block";

  const select = document.createElement("select");
  const initialURL = mapOptions[index % mapOptions.length].url;

  mapOptions.forEach(opt => {
    const option = document.createElement("option");
    option.value = opt.url;
    option.textContent = opt.name;
    if (opt.url === initialURL) option.selected = true;
    select.appendChild(option);
  });

  const container = document.createElement("div");
  container.className = "map-container";

  const iframe = document.createElement("iframe");
  iframe.id = `mapFrame${index}`;
  iframe.src = initialURL;
  iframe.loading = "lazy";
  iframe.allowFullscreen = true;
  iframe.scrolling = "no";
  iframe.frameborder="0";
  iframe.seamless;
  iframe.width="694";
  iframe.height="429";

  select.addEventListener("change", () => {
    iframe.src = select.value; //+ "?v=" + new Date().getTime();
  });

  container.appendChild(iframe);
  mapBlock.appendChild(select);
  mapBlock.appendChild(container);
  wrapper.appendChild(mapBlock);
}

for (let i = 0; i < numberOfBlocks; i++) {
  createMapBlock(i);
}
</script>

</body>
</html>
